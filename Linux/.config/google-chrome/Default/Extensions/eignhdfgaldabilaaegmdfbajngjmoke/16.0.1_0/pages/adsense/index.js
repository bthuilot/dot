cjModules.define(function(){"use strict";return function(e){function t(t){e.textContent="";var n=bmElements.createElement("fulldialog",{serviceLogo:{label:bmRuntime.i18n("cj_i18n_00179","AdSense")},iconName:"adsense",message:t.message,actionLabel:t.actionLabel,action:t.action});e.appendChild(n)}function n(){if(!m){m=!0,e.textContent="";var t=bmElements.createElement("fulldialog",{serviceLogo:{label:bmRuntime.i18n("cj_i18n_00179","AdSense")},iconName:"adsense",message:bmRuntime.i18n("cj_i18n_00233","There is no AdSense account attached to this Google account"),actionLabel:bmRuntime.i18n("cj_i18n_00234","Change account"),action:function(){bmRuntime.changeToPage("account")}});e.appendChild(t)}}function a(e){e&&e.body&&e.body.indexOf("noAdsenseAccount")&&n(),e&&"notAuthorized"===e.error&&t({message:bmRuntime.i18n("cj_i18n_00235","Before you can use this page, you need to give access to load your Google AdSense data"),actionLabel:bmRuntime.i18n("cj_i18n_00224","Give permission"),action:e.authorize})}function i(e){var t=cjBasics.urls.create(l+"reports",{startDate:e.start,endDate:e.end,metric:"EARNINGS",useTimezoneReporting:!0,fields:"headers/currency,totals"});return g.request(t,{fetchAs:"json"},{scope:u}).then(function(e){return{revenue:e.totals[0]||0,currency:e.headers[0].currency}},a)}function o(e){return e>0?"up":e<0?"down":"neutral"}function r(e){var t=cjMaterial.createElement("card",{withPadding:!0});t.classList.add("adsense-card"),t.addEventListener("click",function(){bmRuntime.openTab("https://www.google.com/adsense/app#viewreports/d="+e.reportName)});var n=document.createElement("div");n.className="date-container",n.textContent=e.title,t.appendChild(n);var a=document.createElement("div");a.className="amount",a.textContent="â£",t.appendChild(a);var r;if(e.previous){var d=document.createElement("div");d.className="cj-md-secondarytext in-comparison",d.textContent=e.previous.title,n.appendChild(d),r=document.createElement("div"),r.className="change",t.appendChild(r)}return i({start:e.start,end:e.end}).then(function(t){var n=t.revenue,d=t.currency;a.textContent=n+" "+d,e.previous&&i({start:e.previous.start,end:e.previous.end}).then(function(e){var t=e.revenue,a=e.currency;if(d===a){var i=n-t,s=o(i),c=cjMaterial.createElement("icon",{name:"down"===s?"__mdi:trending_down":"__mdi:trending_up"});r.appendChild(c),r.classList.add(s);var m=Math.round(1e4*Math.abs(i))/1e4+" "+d+" ("+Math.round(1e3*(n/t-1))/10+"%)",u=document.createTextNode(m);r.appendChild(u)}})}),t}function d(){p.forEach(function(e){var t=r(e);c.appendChild(t)}),bmRuntime.toggleLoading("off",e)}function s(){bmRuntime.toggleLoading("on",e);var t=document.createDocumentFragment(),n=bmElements.createElement("pageheader",{color:"#4285f4",pageId:"adsense",pageTitle:bmRuntime.i18n("cj_i18n_00236","Estimated earnings")});t.appendChild(n),c=cjMaterial.createElement("container",{scrollable:!0,shadow:!0,darker:!0}),t.appendChild(c),e.appendChild(t),d()}var c,m,u=["https://www.googleapis.com/auth/adsense.readonly"],l="https://www.googleapis.com/adsense/v1.4/",p=[{title:bmRuntime.i18n("cj_i18n_00225","Today so far"),start:"today",end:"today",reportName:"today"},{title:bmRuntime.i18n("cj_i18n_00226","Yesterday"),start:"today-1d",end:"today-1d",reportName:"yesterday",previous:{title:bmRuntime.i18n("cj_i18n_00227","vs same day last week"),start:"today-8d",end:"today-8d"}},{title:bmRuntime.i18n("cj_i18n_00228","This month so far"),start:"startOfMonth",end:"today",reportName:"thismonth",previous:{title:bmRuntime.i18n("cj_i18n_00229","vs same day last month"),start:"startOfMonth-1m",end:"today-1m"}},{title:bmRuntime.i18n("cj_i18n_00230","Last month"),start:"startOfMonth-1m",end:"startOfMonth-1d",reportName:"lastmonth",previous:{title:bmRuntime.i18n("cj_i18n_00231","vs month before"),start:"startOfMonth-2m",end:"startOfMonth-1m-1d"}},{title:bmRuntime.i18n("cj_i18n_00232","Lifetime"),start:"today-100y",end:"today",reportName:"alltime"}];s()}});